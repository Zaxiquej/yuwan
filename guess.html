<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>影之诗猜卡（beta)</title>
    <style>
  /* 其他样式保持不变 */
  .highlight {
    background-color: yellow;
  }

  /* 猜对时的文本样式 */
  .congrats {
    font-size: 24px;
  }
  /* 烟花特效 */
  #fireworks {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 300px;
    height: 300px;
    transform: translate(-50%, -50%);
    pointer-events: none;
    z-index: 100;
  }

  .firework {
    position: absolute;
    width: 10px;
    height: 10px;
    background-color: #f00;
    border-radius: 50%;
    pointer-events: none;
    animation: explode 1s linear infinite;
  }

  @keyframes explode {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    100% {
      transform: scale(20);
      opacity: 0;
    }
  }
  #playBox {
    display: none;
  }
  #sortingOptions {
    display: none;
  }
  #cSeed {
    display: none;
  }
</style>
</head>
<body>
    <h1>影之诗猜卡</h1>
    <div id="startBox">
      <button id="randomSeedButton">今日谜题种子</button>
      <input type="text" id="seedInput" placeholder="输入种子">
      <button id="useSeedButton">开始游戏</button>
    </div>
    <!--<button id="puzzleStartButton">解谜开始</button> -->
    <div id="sortingOptions">
        <label for="sortOption">排序选项：</label>
        <select id="sortOption">
          <option value="similarity">根据相似度排序</option>
          <option value="index">根据序号排序</option>
        </select>
        <button id="sortButton">确认排序</button>
        <hr> <!-- 这是分割线 -->
    </div>
  <div id="cSeed">
  <p id="currentSeed">当前种子：</p>
  <p>第10名卡牌相似度：<span id="rank10Similarity">-</span></p>
  <p>第100名卡牌相似度：<span id="rank100Similarity">-</span></p>
  <p>第1000名卡牌相似度：<span id="rank1000Similarity">-</span></p>
</div>
    <div id="playBox">
    <div id="guessBox">
    <input type="text" id="guessInput" placeholder="输入猜测的卡牌名称">
    <button id="guessButton">确认</button>
    </div>
    <div id="suggestions"></div>
    <hr> <!-- 这是分割线 -->
    <div id="history"></div>
    <button id="hintButton">提示</button>
    <button id="restartButton">重新开始</button>
    </div>

    <div id="fireworks"></div>

<hr> <!-- 这是分割线 -->
    <div id="ruleBox">
       <h2>规则说明</h2>
       <p>1. 选择一个种子，然后点击“开始游戏”按钮，系统会随机抽取一张卡牌作为解谜目标。</p>
       <p>2. 在输入框中输入猜测的卡牌名称，并点击“确认”按钮，系统会告诉你这次猜测的相似度和在所有卡牌中的排名。</p>
       <p>3. 相似度越高，排名越靠前，表示你的猜测与目标卡牌越相似。</p>
       <p>4. 猜错了可以继续猜，直到猜对为止。试试你要几次才能猜到目标卡牌吧！</p>
       <p>5. 由于需要搜索数据库，开始游戏和提示时有卡顿是正常现象。</p>

       <h2>常见问题解答</h2>
       <details>
           <summary>1. 系统会选择哪些卡牌作为解谜目标？</summary>
           <p>系统会从已有的卡牌数据库中随机选择一张卡牌作为解谜目标。</p>
           <p>目前数据库截止至：密斯塔尔希亚的英雄，DLC前</p>
       </details>
       <details>
           <summary>2. 如果我找不到某个卡牌怎么办？</summary>
           <p>如果找不到相应的卡牌，请检查输入的名称是否正确。数据库来自于shadowverseportal进行简化，因此可能有部分卡名称和国服采用的有出入。</p>
           <p>一般来说，近似词提示中可以找到你想要的卡牌；如果找不到，或发现卡名出入太大，请联系作者。</p>
       </details>
       <details>
           <summary>3. 具体而言，相似度是如何判定的?</summary>
           <p>相似度的判定有三部分：</p>
           <li>基础分：卡牌的类型、种类、费用、稀有度、（如果是随从）进化前后的攻击与生命。其中基础分的40%在于两张卡是否是同类型；如果是随从这部分会允给身材。</li>
           <li>技能分：卡牌具有的特殊能力，会检查双方共享能力在双方总能力之中的占比，如果有同能力但数据不同会有相应的扣分。得到结果开根为最终分数。</li>
           <li>描述分：卡牌的描述文字，会检查双方描述文字的Levenshtein距离。在此基础上，如果双方描述有公用部分，则有一个最高50%的补正。</li>
           <p>系统会对这三部分各打一个分，随后按照2:4:4的权重生成总分，满分为100。</p>
       </details>
       <details>
           <summary>4. 卡牌的相似度我所想象的不太一样！</summary>
           <p>嗯，这是可能发生的，这有几种可能性：</p>
           <li>1、系统并不能探知卡牌的token，只会对卡牌本身的能力判断。比如，矮人技师不会被认为和人偶系的卡牌相似度接近，但是会被认为和抉择拿token的卡牌相似度接近。</li>
           <li>2、名字相似甚至复刻角色并不代表卡牌相似度接近。比如邪龙‧林德沃姆相似度最近的是重装巨怪。而风之军神‧格里姆尼尔和飓风军神‧格里姆尼尔很接近，却和另外两个风军不太接近。</li>
           <li>3、占字数多的描述会在描述分里有更多影响。比如游猎的罪人‧安媞马丽亚会与能制造低费自己的伟大的调停者‧佐伊和死骸金属巨星更接近，而不是具有穿墙疾走的邪龙·林德沃姆。</li>
           <li>4、目前技能处理的算法只考虑效益，在效益基础上考虑cost。简单来说就是如果有葬送抽一会被认为和谢幕曲抽一类似，而不是如果葬送则随机打三</li>
           <li>5、相似度的判定有三部分（见上），可能你选择的卡在其中一部分有较高的分数，但是就总分的考量偏低。比如观星魔女·斯特拉感觉上应该和占星术非常接近，但实际上虽然两者描述分很高，基础分和技能分（观星魔女没有减费能力）会拉掉很多分。</li>
           <li>6、同特效正反两个方向会被认为接近。比如跳1费和扣1费在判断里其实差的不远。</li>
           <li>7、系统一般只考虑最外层能力，例，蛇殿和猫猫头会被认为不相似，因为蛇殿是“给主战者贴能力”，而猫猫头是扣对面上限。</li>
           <li>9、待补充</li>
       </details>
       <details>
           <summary>5. 关于一些技能</summary>
           <p>瞬念召唤在技能上被算为“召唤卡牌”，会和其他召唤卡牌的卡有同一个技能，但是在描述上两者具有差别。</p>
           <p>爆能强化、激奏和结晶在技能处理是一个系统的。</p>
           <p>回费和跳费也是一个系统的，不过具体系数有分开就是</p>
       </details>
       <details>
           <summary>6. 关于相似度算法</summary>
           <p>相似度算法还在优化中，但是你可以先体验一下游戏（指被拉血压）。</p>
       </details>
       <details>
           <summary>7. 每天生成的种子是固定的吗？</summary>
           <p>是的。如果你想要玩别的，你可以输入之前的种子。</p>
           <p>这么做的理由：</p>
           <li>1、其他猜词游戏也是这么做的（</li>
           <li>2、可以让你和狱友讨论今日卡牌，当然要小心被剧透</li>
           <li>3、如果你暂时卡关了，可以暂停片刻，之后回来继续！</li>
           <p>当然，如果你想玩更多，你可以随便输入一些东西作为种子！你还可以把你脸滚键盘生成的种子分享给群友（</p>
       </details>
       <details>
           <summary>8. 过去的谜题</summary>
           <li>2023/08/06 Vrut4aWV</li>
           <li>2023/08/07 e5qHb1IB</li>
       </details>
   </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/seedrandom.min.js"></script>
    <script src="library/database.js"></script>
    <script src="SimpTrad.js"></script>
    <script src="similarity.js"></script>
    <script src="guess.js"></script>
</body>
</html>
